<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WagyDog - The Next Big Meme Coin on BNB Chain</title>
    
    <link rel="icon" type="image/jpeg" href="wagydog-logo.jpg">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js" type="application/javascript"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #F8F9FD;
            color: #1E293B;
            overflow-x: hidden;
        }
        .gradient-text {
            background: linear-gradient(90deg, #2E90FA, #F9D423);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .btn-primary {
            @apply bg-blue-500 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:shadow-blue-500/50 hover:bg-blue-600 transform hover:scale-105 transition-all duration-300 ease-in-out disabled:bg-gray-400 disabled:shadow-none disabled:scale-100;
        }
        .btn-secondary {
            @apply bg-gray-200 text-gray-800 font-bold py-3 px-8 rounded-full shadow-md hover:shadow-lg hover:bg-gray-300 transform hover:scale-105 transition-all duration-300 ease-in-out;
        }
        .content-card {
            @apply bg-white/80 backdrop-blur-sm p-6 md:p-8 rounded-3xl shadow-xl hover:shadow-2xl border border-gray-200 transition-all duration-300;
        }
        .nav-link {
             @apply text-gray-700 hover:text-blue-500 font-semibold transition-colors duration-300;
        }
        .social-icon {
            @apply text-gray-500 hover:text-blue-500 transition-all duration-300 transform hover:scale-110;
        }
        .partner-logo {
            @apply h-10 grayscale opacity-60 hover:grayscale-0 hover:opacity-100 transition-all duration-300;
        }

        /* === Space Theme & Animations === */
        .space-bg {
            position: relative;
            background-color: #0c0a18; /* Deep space blue */
            color: #e0e0e0;
        }
        #starfield {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        .space-content {
            position: relative;
            z-index: 1;
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-25px); }
            100% { transform: translateY(0px); }
        }
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        .fade-in-section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        .animated-coming-soon {
            @apply font-black text-white;
            animation: pulse-glow 2.5s ease-in-out infinite;
        }
        @keyframes pulse-glow {
            0%, 100% { opacity: 1; text-shadow: 0 0 10px #D946EF, 0 0 20px #D946EF; }
            50% { opacity: 0.7; text-shadow: 0 0 20px #D946EF, 0 0 30px #D946EF; }
        }
    </style>
</head>
<body class="relative">

    <header class="fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-md shadow-sm">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="#home" class="flex items-center space-x-3">
                <img src="wagydog-logo.jpg" alt="WagyDog Logo" class="h-12 w-auto">
                <span class="text-2xl font-black text-gray-800 hidden sm:inline">WagyDog</span>
            </a>
            <nav class="hidden md:flex items-center space-x-8">
                <a href="#about" class="nav-link">About</a>
                <a href="https://wagydog.gitbook.io/wagydog-whitepaper" target="_blank" class="nav-link">Whitepaper</a>
                <a href="#roadmap" class="nav-link">Roadmap</a>
                <a href="#nft" class="nav-link">NFTs</a>
                <a href="#contact" class="nav-link">Contact</a>
                <a href="#partners" class="nav-link">Partners</a>
            </nav>
            <a href="#" class="hidden md:inline-block btn-primary">Buy Now</a>
            <button id="menu-btn" class="md:hidden focus:outline-none z-50">
                <i class="fas fa-bars text-2xl text-gray-700"></i>
            </button>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white/95">
             <div class="flex flex-col items-center space-y-6 py-8">
                <a href="#about" class="nav-link mobile-link">About</a>
                <a href="https://wagydog.gitbook.io/wagydog-whitepaper" target="_blank" class="nav-link mobile-link">Whitepaper</a>
                <a href="#roadmap" class="nav-link mobile-link">Roadmap</a>
                <a href="#nft" class="nav-link mobile-link">NFTs</a>
                <a href="#contact" class="nav-link mobile-link">Contact</a>
                <a href="#partners" class="nav-link mobile-link">Partners</a>
                <a href="#" class="btn-primary mt-4 mobile-link">Buy Now</a>
            </div>
        </div>
    </header>

    <main>
        <section id="home" class="pt-32 pb-16 md:pt-48 md:pb-24 flex items-center px-6">
            <div class="container mx-auto grid md:grid-cols-2 gap-12 items-center">
                <div class="text-center md:text-left">
                    <h1 class="text-5xl md:text-7xl font-black text-gray-800 leading-tight">
                        A New Breed of <br class="hidden md:block"/> <span class="gradient-text">Meme Coin</span>
                    </h1>
                    <p class="text-lg md:text-xl mt-6 max-w-xl mx-auto md:mx-0 text-gray-600">
                        WagyDog is wagging its tail on the BNB Chain, combining fun, community, and real utility.
                    </p>
                    <div class="mt-10 flex flex-col sm:flex-row gap-4 justify-center md:justify-start">
                        <a href="#" class="btn-primary">Get Started</a>
                        <a href="#about" class="btn-secondary">Learn More</a>
                    </div>
                </div>
                <div class="flex justify-center p-4">
                    <img src="wagydog-logo.jpg" alt="WagyDog Official Logo" class="w-full max-w-sm md:max-w-md animate-float">
                </div>
            </div>
        </section>

        <section id="about" class="py-20 px-6 space-bg overflow-hidden fade-in-section">
            <canvas id="starfield"></canvas>
            <div class="container mx-auto space-content">
                <div class="text-center">
                    <h2 class="text-4xl font-bold text-white">About <span class="gradient-text">WagyDog</span></h2>
                </div>
                <div class="max-w-4xl mx-auto content-card bg-white/10 text-white border-white/20 mt-12 space-y-6 animate-float" style="animation-duration: 10s;">
                    <p class="text-gray-300 text-lg leading-relaxed">WagyDog is a decentralized movement championing the idea that fun, finance, and freedom can coexist in the Web3 era. We are more than a token; we are a community-driven project on the BNB Chain, designed to merge the viral power of meme culture with tangible utility and genuine community governance.</p>
                </div>
            </div>
        </section>

        <section id="whitepaper-cta" class="py-16 px-6 bg-gray-100 fade-in-section">
            <div class="container mx-auto text-center">
                <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6">Dive deeper into the WagyDog universe.</h3>
                <a href="https://wagydog.gitbook.io/wagydog-whitepaper" target="_blank" class="btn-primary inline-flex items-center gap-2">
                    <i class="fas fa-book-open"></i>
                    Read The Whitepaper
                </a>
            </div>
        </section>

        <section id="roadmap" class="py-20 px-6 fade-in-section">
            <div class="container mx-auto">
                <h2 class="text-4xl font-bold text-center mb-16 text-gray-800">Our <span class="gradient-text">Roadmap</span></h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="content-card text-center transform hover:-translate-y-2 transition-all duration-300">
                        <div class="text-3xl font-bold gradient-text mb-4">01</div>
                        <h3 class="text-xl font-bold mb-3 text-gray-800">Foundation</h3>
                        <ul class="text-gray-600 space-y-2">
                            <li>Contract Development</li>
                            <li>Website & Whitepaper</li>
                            <li>Community Building</li>
                            <li>Fair Launch</li>
                        </ul>
                    </div>
                    <div class="content-card text-center transform hover:-translate-y-2 transition-all duration-300">
                        <div class="text-3xl font-bold gradient-text mb-4">02</div>
                        <h3 class="text-xl font-bold mb-3 text-gray-800">Growth</h3>
                        <ul class="text-gray-600 space-y-2">
                            <li>Listings on CMC/CG</li>
                            <li>Contract Audit</li>
                            <li>Marketing Campaigns</li>
                            <li>CEX Listing</li>
                        </ul>
                    </div>
                    <div class="content-card text-center transform hover:-translate-y-2 transition-all duration-300">
                        <div class="text-3xl font-bold gradient-text mb-4">03</div>
                        <h3 class="text-xl font-bold mb-3 text-gray-800">Ecosystem</h3>
                        <ul class="text-gray-600 space-y-2">
                            <li>NFT Collection</li>
                            <li>NFT Staking</li>
                            <li>WagySwap DEX</li>
                            <li>Governance</li>
                        </ul>
                    </div>
                    <div class="content-card text-center transform hover:-translate-y-2 transition-all duration-300">
                        <div class="text-3xl font-bold gradient-text mb-4">04</div>
                        <h3 class="text-xl font-bold mb-3 text-gray-800">Future</h3>
                        <ul class="text-gray-600 space-y-2">
                            <li>WagyDog Wallet</li>
                            <li>P2E Game</li>
                            <li>Charity Donations</li>
                            <li>Cross-Chain</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section id="nft" class="py-20 px-6 space-bg overflow-hidden fade-in-section">
             <canvas id="starfield2"></canvas>
             <div class="container mx-auto space-content">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold mb-4 text-white">Wagy <span class="gradient-text">NFT Collection</span></h2>
                    <p class="text-lg text-gray-400 max-w-2xl mx-auto">Connect your wallet to mint exclusive WagyDog NFTs and explore the marketplace.</p>
                </div>

                <div id="nft-controls" class="max-w-3xl mx-auto content-card bg-white/10 border-white/20 flex flex-col md:flex-row items-center justify-between gap-6 mb-16">
                    <div class="text-center md:text-left">
                        <h3 class="text-2xl font-bold text-white">Get Your Wagy NFT</h3>
                        <p id="wallet-status" class="text-gray-400 mt-1">Connect your wallet to begin</p>
                    </div>
                    <div class="flex-shrink-0">
                        <button id="connect-wallet-btn" class="btn-primary">Connect Wallet</button>
                        <button id="mint-nft-btn" class="btn-primary hidden" disabled>Mint Now (0.05 BNB)</button>
                    </div>
                </div>

                <div id="nft-gallery-container" class="hidden">
                    <div>
                        <h3 class="text-3xl font-bold text-white mb-8 text-center">My <span class="gradient-text">Wagy NFTs</span></h3>
                        <div id="my-nfts-gallery" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                            </div>
                         <p id="no-my-nfts-message" class="text-center text-gray-400 text-lg hidden">You don't own any Wagy NFTs yet. Mint one above!</p>
                    </div>

                    <hr class="border-white/20 my-16">

                    <div>
                        <h3 class="text-3xl font-bold text-white mb-8 text-center">Marketplace <span class="gradient-text">Listings</span></h3>
                        <div id="marketplace-gallery" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                           </div>
                        <p id="no-market-nfts-message" class="text-center text-gray-400 text-lg hidden">No Wagy NFTs are currently listed for sale.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="py-20 px-6 fade-in-section">
            <div class="container mx-auto text-center max-w-2xl">
                <h2 class="text-4xl font-bold mb-4 text-gray-800">Get <span class="gradient-text">WagyDog</span></h2>
                <p class="text-lg text-gray-600 mb-8">The contract address will be released after a full security audit. Stay tuned!</p>
                <div class="content-card inline-block">
                    <p class="text-lg md:text-xl font-mono break-all text-gray-700">
                        Address: <span class="font-bold">Coming Soon... </span> 
                        <i class="fas fa-hourglass-half ml-2 text-blue-500 animate-spin"></i>
                    </p>
                </div>
                 <p class="text-lg text-gray-600 mt-12 mb-4">Have questions? Reach out to the team.</p>
                 <a href="mailto:Wagydogmeme@gmail.com" class="inline-flex items-center gap-2 text-xl font-bold text-blue-600 hover:underline">
                    <i class="fas fa-envelope"></i>
                    Wagydogmeme@gmail.com
                 </a>
            </div>
        </section>
        
        <section id="partners" class="py-20 px-6 bg-gray-100 fade-in-section">
            <div class="container mx-auto text-center">
                <h2 class="text-3xl font-bold text-gray-800 mb-12">Partners & <span class="gradient-text">Supporters</span></h2>
                <div class="flex flex-wrap justify-center items-center gap-x-12 sm:gap-x-16 gap-y-8">
                    <a href="https://www.bnbchain.org/" target="_blank" class="partner-logo">
                        <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/1839.png" alt="BNB Chain">
                    </a>
                    <a href="https://pancakeswap.finance/" target="_blank" class="partner-logo">
                         <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/7186.png" alt="PancakeSwap">
                    </a>
                    <a href="https://coinmarketcap.com/" target="_blank" class="partner-logo">
                         <img src="https://s2.coinmarketcap.com/static/cloud/img/coinmarketcap_1.svg?_=810f399" alt="CoinMarketCap" style="height: 35px;">
                    </a>
                </div>
            </div>
        </section>

        <section id="community" class="py-20 px-6">
            <div class="container mx-auto text-center">
                <h2 class="text-4xl font-bold">Join Our <span class="gradient-text">Community</span></h2>
                <p class="text-lg text-gray-600 mt-4 mb-8">Stay up to date with the latest news and announcements.</p>
                <div class="flex justify-center space-x-6">
                    <a href="https://t.me/+KazLf4Tt1e9jZmVk" target="_blank" class="social-icon text-4xl">
                        <i class="fab fa-telegram-plane"></i>
                    </a>
                    <a href="https://x.com/wagydog" target="_blank" class="social-icon text-4xl">
                        <i class="fab fa-twitter"></i>
                    </a>
                </div>
            </div>
        </section>
    </main>

    <footer class="py-8 px-6 border-t border-gray-200">
        <div class="container mx-auto sm:flex justify-between items-center text-center">
             <div class="flex justify-center space-x-6 mb-4 sm:mb-0">
                <a href="https://t.me/+KazLf4Tt1e9jZmVk" target="_blank" class="social-icon">
                    <i class="fab fa-telegram-plane fa-lg"></i>
                </a>
                <a href="https://x.com/wagydog" target="_blank" class="social-icon">
                    <i class="fab fa-twitter fa-lg"></i>
                </a>
            </div>
            <p class="text-gray-500">&copy; 2025 WagyDog. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
        // --- EXISTING SCRIPT ---
        // Mobile menu toggle
        const menuBtn = document.getElementById('menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileLinks = document.querySelectorAll('.mobile-link');

        menuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        mobileLinks.forEach(link => {
            link.addEventListener('click', () => {
                mobileMenu.classList.add('hidden');
            });
        });

        // Scroll-in animations
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.fade-in-section').forEach(section => {
            observer.observe(section);
        });

        // Starfield Animation
        function createStarfield(canvasId) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            
            let stars = [];
            let numStars = 200;

            function resizeCanvas() {
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;
                stars = [];
                for (let i = 0; i < numStars; i++) {
                    stars.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        radius: Math.random() * 1.5 + 0.5,
                        vx: (Math.random() - 0.5) * 0.5,
                        vy: (Math.random() - 0.5) * 0.5
                    });
                }
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                for (let i = 0, x = stars.length; i < x; i++) {
                    let s = stars[i];
                    ctx.fillStyle = "#fff";
                    ctx.beginPath();
                    ctx.arc(s.x, s.y, s.radius, 0, 2 * Math.PI);
                    ctx.fill();
                    s.x += s.vx;
                    s.y += s.vy;
                    if (s.x < 0 || s.x > canvas.width) s.x = Math.random() * canvas.width;
                    if (s.y < 0 || s.y > canvas.height) s.y = Math.random() * canvas.height;
                }
                requestAnimationFrame(animate);
            }
            
            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();
            animate();
        }

        createStarfield('starfield');
        createStarfield('starfield2');

    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- CONFIGURATION ---
            const contractAddress = "0xYourContractAddressHere"; // <-- REPLACE WITH YOUR CONTRACT ADDRESS
            const contractABI = [ // <-- REPLACE WITH YOUR ABI
                "function mint() public payable",
                "function listForSale(uint256 tokenId, uint256 price) public",
                "function ownerOf(uint256 tokenId) view returns (address)",
                "function purchase(uint256 tokenId) public payable" // Added for buying
            ];
            const mintPrice = "0.05"; // Mint price in BNB

            // --- UI ELEMENTS ---
            const connectBtn = document.getElementById('connect-wallet-btn');
            const mintBtn = document.getElementById('mint-nft-btn');
            const walletStatus = document.getElementById('wallet-status');
            const galleryContainer = document.getElementById('nft-gallery-container');
            const myNftsGallery = document.getElementById('my-nfts-gallery');
            const marketplaceGallery = document.getElementById('marketplace-gallery');
            const noMyNftsMsg = document.getElementById('no-my-nfts-message');
            const noMarketNftsMsg = document.getElementById('no-market-nfts-message');

            // --- DUMMY DATA ---
            const dummyNfts = [
                { tokenId: 1, name: 'Cosmic Wagy #1', image: 'https://via.placeholder.com/300/2E90FA/FFFFFF?text=Wagy+1', owner: '0x1111111111111111111111111111111111111111', isForSale: true, price: '0.1' },
                { tokenId: 2, name: 'Nebula Pup #2', image: 'https://via.placeholder.com/300/F9D423/000000?text=Wagy+2', owner: '0x2222222222222222222222222222222222222222', isForSale: false, price: '0' },
                { tokenId: 3, name: 'Galaxy Doggo #3', image: 'https://via.placeholder.com/300/D946EF/FFFFFF?text=Wagy+3', owner: '0x1111111111111111111111111111111111111111', isForSale: true, price: '0.25' },
                { tokenId: 4, name: 'Star Chaser #4', image: 'https://via.placeholder.com/300/10B981/FFFFFF?text=Wagy+4', owner: '0xYourConnectedAddressHere', isForSale: false, price: '0' }, // Dummy owned NFT
            ];

            // --- STATE VARIABLES ---
            let provider, signer, contract, connectedAccount;

            // --- FUNCTIONS ---
            const connectWallet = async () => {
                if (typeof window.ethereum === 'undefined') {
                    walletStatus.textContent = 'Please install MetaMask!';
                    return;
                }
                try {
                    provider = new ethers.providers.Web3Provider(window.ethereum);
                    const accounts = await provider.send("eth_requestAccounts", []);
                    signer = provider.getSigner();
                    contract = new ethers.Contract(contractAddress, contractABI, signer);
                    connectedAccount = accounts[0];
                    updateUIForConnection();
                } catch (error) {
                    console.error("Failed to connect wallet:", error);
                    walletStatus.textContent = 'Connection failed. Please try again.';
                }
            };

            const updateUIForConnection = () => {
                const shortAddress = `${connectedAccount.substring(0, 6)}...${connectedAccount.substring(connectedAccount.length - 4)}`;
                walletStatus.innerHTML = `Connected: <span class="font-bold text-white">${shortAddress}</span>`;
                connectBtn.classList.add('hidden');
                mintBtn.classList.remove('hidden');
                mintBtn.disabled = false;
                galleryContainer.classList.remove('hidden');
                displayNfts();
            };

            const displayNfts = () => {
                myNftsGallery.innerHTML = '';
                marketplaceGallery.innerHTML = '';

                let myNftsCount = 0;
                let marketNftsCount = 0;

                // Use a version of dummy data where one NFT is owned by the current user
                const personalizedDummyNfts = JSON.parse(JSON.stringify(dummyNfts).replace(/0xYourConnectedAddressHere/g, connectedAccount));

                personalizedDummyNfts.forEach(nft => {
                    if (nft.owner.toLowerCase() === connectedAccount.toLowerCase()) {
                        myNftsGallery.innerHTML += createMyNftCard(nft);
                        myNftsCount++;
                    }
                    if (nft.isForSale && nft.owner.toLowerCase() !== connectedAccount.toLowerCase()) {
                        marketplaceGallery.innerHTML += createMarketplaceNftCard(nft);
                        marketNftsCount++;
                    }
                });

                noMyNftsMsg.style.display = myNftsCount === 0 ? 'block' : 'none';
                noMarketNftsMsg.style.display = marketNftsCount === 0 ? 'block' : 'none';
            };

            const createMyNftCard = (nft) => {
                return `
                    <div class="content-card bg-white/10 border-white/20 text-white p-4 space-y-4">
                        <img src="${nft.image}" alt="${nft.name}" class="rounded-lg w-full aspect-square object-cover">
                        <h4 class="text-xl font-bold">${nft.name}</h4>
                        <form class="list-form space-y-2" data-token-id="${nft.tokenId}">
                            <input type="text" placeholder="Price in BNB (e.g., 0.1)" class="w-full bg-black/30 text-white rounded-md px-3 py-2 border border-white/20 focus:ring-2 focus:ring-blue-500 focus:outline-none" required>
                            <button type="submit" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">List for Sale</button>
                        </form>
                    </div>
                `;
            };

            const createMarketplaceNftCard = (nft) => {
                return `
                     <div class="content-card bg-white/10 border-white/20 text-white p-4 space-y-3">
                        <img src="${nft.image}" alt="${nft.name}" class="rounded-lg w-full aspect-square object-cover">
                        <h4 class="text-xl font-bold">${nft.name}</h4>
                        <p class="text-lg font-semibold text-yellow-400">${nft.price} BNB</p>
                        <button class="buy-btn w-full btn-primary" data-token-id="${nft.tokenId}" data-price="${nft.price}">Buy Now</button>
                    </div>
                `;
            };

            const mintNFT = async () => {
                if (!contract) return;
                mintBtn.disabled = true;
                mintBtn.textContent = 'Minting...';
                try {
                    const tx = await contract.mint({ value: ethers.utils.parseEther(mintPrice) });
                    await tx.wait();
                    alert('Mint successful!');
                    // In a real app, you would now refresh the NFT list
                } catch (error) {
                    console.error("Minting failed:", error);
                    alert('Minting failed. Check console for details.');
                } finally {
                    mintBtn.disabled = false;
                    mintBtn.textContent = `Mint Now (${mintPrice} BNB)`;
                }
            };

            const handleListForSale = async (event) => {
                event.preventDefault();
                if (!contract) return;

                const form = event.target;
                const tokenId = form.dataset.tokenId;
                const price = form.querySelector('input').value;
                const button = form.querySelector('button');

                if (!price || isNaN(price) || parseFloat(price) <= 0) {
                    alert('Please enter a valid price.');
                    return;
                }
                
                button.disabled = true;
                button.textContent = 'Listing...';

                try {
                    const priceInWei = ethers.utils.parseEther(price);
                    const tx = await contract.listForSale(tokenId, priceInWei);
                    await tx.wait();
                    alert(`NFT #${tokenId} listed for sale!`);
                } catch (error) {
                    console.error("Listing failed:", error);
                    alert('Listing failed. Check console for details.');
                } finally {
                    button.disabled = false;
                    button.textContent = 'List for Sale';
                }
            };
            
             const handleBuy = async (event) => {
                if (!contract) return;
                
                const button = event.target;
                const tokenId = button.dataset.tokenId;
                const price = button.dataset.price;
                
                button.disabled = true;
                button.textContent = 'Purchasing...';
                
                try {
                    const priceInWei = ethers.utils.parseEther(price);
                    const tx = await contract.purchase(tokenId, { value: priceInWei });
                    await tx.wait();
                    alert(`NFT #${tokenId} purchased successfully!`);
                    // In a real app, you would now refresh the NFT list
                } catch (error) {
                    console.error("Purchase failed:", error);
                    alert('Purchase failed. Check console for details.');
                } finally {
                    button.disabled = false;
                    button.textContent = 'Buy Now';
                }
            };

            // --- EVENT LISTENERS ---
            connectBtn.addEventListener('click', connectWallet);
            mintBtn.addEventListener('click', mintNFT);
            
            // Use event delegation for dynamically created forms and buttons
            document.body.addEventListener('submit', (event) => {
                if (event.target.classList.contains('list-form')) {
                    handleListForSale(event);
                }
            });
            document.body.addEventListener('click', (event) => {
                if (event.target.classList.contains('buy-btn')) {
                    handleBuy(event);
                }
            });
        });
    </script>
</body>
</html>
